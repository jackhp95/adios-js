const e=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t=e=>e.replace(/-./g,(e=>e.toUpperCase()[1])),r=(e,...t)=>[...new Set(e)].filter((e=>t.every((t=>t.includes(e))))),n=(e,t)=>t.split(".").reduce(((e,t)=>e&&e[t]),e),a=(e,t,r)=>t.split(".").reduce(((e={},t,n,{length:a})=>n+1===a?e[t]=r:t in e?e[t]:e[t]={}),e),s=(e,t=new WeakMap)=>{if(Object(e)!==e)return e;if(t.has(e))return t.get(e);const r=e instanceof Set?new Set(e):e instanceof Map?new Map(Array.from(e,(([e,r])=>[e,s(r,t)]))):e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e.constructor?new e.constructor:Object.create(null);return t.set(e,r),Object.assign(r,...Object.keys(e).map((r=>({[r]:s(e[r],t)}))))},o=e=>e&&"object"==typeof e&&!Array.isArray(e),l=(e,...t)=>{if(!t.length)return e;const r=t.shift();if(o(e)&&o(r))for(const t in r)o(r[t])?(e[t]||Object.assign(e,{[t]:{}}),l(e[t],r[t])):Object.assign(e,{[t]:r[t]});return l(e,...t)},c=e=>e;function i(){var e=[],t=[],r=[],n=null,a=(s,o,l)=>{var c=o||null,i=l||[{target:s,property:""}];s instanceof Array&&(s.__length=s.length);var u=[],f=(e,t,r)=>{for(var n="",a=null,s=0;s<i.length;s++)a instanceof Array&&!isNaN(i[s].property)&&(i[s].property=a.indexOf(i[s].target)),n=n+"."+i[s].property,a=i[s].target;return n=(n=n+"."+t).substring(2),!0===r&&(n="/"+n.replace(/\./g,"/")),n},h=e=>{if("undefined"!=typeof requestIdleCallback)requestIdleCallback((()=>{if(e===u.length){var t=[...u];u=[],c.observers.forEach((e=>e(t)))}}));else{var t=[...u];u=[],c.observers.forEach((e=>e(t)))}},d={get:(e,n)=>{if("__getTarget"===n)return e;if("__isProxy"===n)return!0;if("__getParent"===n)return e=>{if(void 0===e)e=1;var t=f(0,"__getParent").split(".");return t.splice(-(e+1),e+1),((e,t)=>t.split(".").reduce(((e,t)=>e?e[t]:void 0),e||self))(c.parentProxy,t.join("."))};if("__getPath"===n)return f(0,"__getParent").slice(0,-12);var s=e[n];if(e instanceof Date&&s instanceof Function&&null!==s)return s.bind(e);if(s instanceof Object&&null!==s&&e.hasOwnProperty(n)){if(!0===s.__isProxy&&(s=s.__getTarget),s.__targetPosition>-1&&null!==t[s.__targetPosition])for(var o=r[s.__targetPosition],l=0,u=o.length;l<u;l++)if(c===o[l].observable)return o[l].proxy;var h=[...i];return h.push({target:s,property:n}),a(s,c,h)}return s},deleteProperty:(e,a)=>{var s=!0;n===g&&(s=!1,n=null);var o=Object.assign({},e);if(u.push({type:"delete",target:e,property:a,newValue:null,previousValue:o[a],currentPath:f(0,a),jsonPointer:f(0,a,!0),proxy:g}),!0===s){c.changesPaused||delete e[a];for(var l=0,i=t.length;l<i&&e!==t[l];l++);for(var d=r[l]||[],p=d.length;p--;)d[p].proxy!==g&&(n=d[p].proxy,delete d[p].proxy[a])}return h(u.length),!0},set:(e,a,s,o)=>{s&&s.__isProxy&&(s=s.__getTarget);var l=!0;n===g&&(l=!1,n=null);var i=e[a];if(i!==s||!1===l||"length"===a&&e instanceof Array&&e.__length!==s){var d=!0,p=typeof i,b="update";if("undefined"===p&&(b="add"),u.push({type:b,target:e,property:a,newValue:s,previousValue:o[a],currentPath:f(0,a),jsonPointer:f(0,a,!0),proxy:g}),"length"===a&&e instanceof Array&&e.__length!==s&&(u[u.length-1].previousValue=e.__length,e.__length=s),!0===l){c.changesPaused||(e[a]=s),d=!1;for(var v=e.__targetPosition,y=r[v].length;y--;)if(c===r[v][y].observable&&null!==t[r[v][y].observable.parentTarget.__targetPosition]){d=!0;break}if(d){for(var _=r[v],m=0,j=_.length;m<j;m++)_[m].proxy!==g&&(n=_[m].proxy,_[m].proxy[a]=s);requestAnimationFrame((()=>setTimeout((()=>{if("object"===p&&null!==i){for(var n=Object.keys(e),a=0,s=n.length;a<s;a++)if(e[n[a]]===i)return;var o=!1;if(function e(t){for(var r=Object.keys(t),n=0,a=r.length;n<a;n++){var s=t[r[n]];if(s instanceof Object&&null!==s&&e(s),s===i)return void(o=!0)}}(e),!0===o)return;!function e(n){for(var a=Object.keys(n),s=0,o=a.length;s<o;s++){var l=n[a[s]];l instanceof Object&&null!==l&&e(l)}var i=-1;for(s=0,o=t.length;s<o;s++)if(n===t[s]){i=s;break}if(i>-1){for(var u=r[i],f=u.length;f--;)if(c===u[f].observable){u.splice(f,1);break}0==u.length&&(t[i]=null)}}(i)}}),0)))}}d&&h(u.length)}return!0}},p=s.__targetPosition;p>-1||Object.defineProperty(s,"__targetPosition",{value:t.length,writable:!1,enumerable:!1,configurable:!1});var g=new Proxy(s,d);null===c&&(c={parentTarget:s,parentProxy:g,observers:[],paused:!1,path:i,changesPaused:!1},e.push(c));var b={target:s,proxy:g,observable:c};return p>-1?(null===t[p]&&(t[p]=s),r[p].push(b)):(t.push(s),r.push([b])),g};return{create:function(e,t){if(!0===e.__isProxy)e=e.__getTarget;var r=a(e);return"function"==typeof t&&this.observe(r,t),function e(t){for(var r=t.__getTarget,n=Object.keys(r),a=0,s=n.length;a<s;a++){var o=n[a];r[o]instanceof Object&&null!==r[o]&&e(t[o])}}(r),r},observe:(t,r)=>{for(var n=e.length;n--;)if(e[n].parentProxy===t){e[n].observers.push(r);break}}}}const u=e=>({push:(t,r)=>()=>t[e]=r,pull:t=>t[e]||void 0}),f=e=>({push:(t,r={})=>{const n=t.dataset.each,a=Object.keys(r).filter((e=>!/^__/.exec(e))),s=t.parentElement,[o,l]=a.map((r=>{const a=t.content.firstElementChild.cloneNode(!0),s=[a,...a.querySelectorAll(e.util.selectors())];return[a,s.flatMap((t=>Object.entries(t.dataset).filter((([t,r])=>Object.keys(e.codecs).includes(t))).flatMap((([a,s])=>{const o=s.startsWith("~")?s.substring(1):`${n}.${r}.${s}`;return t.dataset[a]=o,e.codecs[a].push(t,e.resolver(o))}))))]})).reduce((([e,t],[r,n])=>[[...e,r],[...t,...n]]),[[],[]]);return l.map((e=>e())),()=>{[...s.children].filter((e=>e!==t)).forEach((e=>e.remove())),s.append(...o)}},pull:t=>{const n=t.dataset.each,s={},o=e.util.elements(n,!0),l=Object.keys(e.codecs).filter((e=>"each"!==e));return o.forEach((t=>{r(Object.keys(t.dataset),l).forEach((r=>{const o=e.codecs[r].pull(t),l=t.dataset[r].replace(n+".","");a(s,l,o)}))})),s}}),h=e=>({push:(t,r)=>()=>requestAnimationFrame((()=>{const r=e.resolver(t.dataset.src);r?fetch(r).then((r=>r.text().catch(console.log).then((r=>{if(t?.nextElementSibling?.dataset?.injected)return;const n=document.createElement("div");n.classList.add(...t.classList),n.innerHTML=r,t.insertAdjacentElement("afterend",n),n.dataset.injected=!0,e.util.hide(t)})))):console.log("No data-src resolved for data-inject to inject",{el:t,src:t.dataset.src,url:r})})),pull:e=>e?.nextElementSibling?.dataset?.injected&&e?.nextElementSibling?.outerHtml}),d=e=>(t,r,n=!0)=>{const a=e=>n?!e:!!e;return{[t]:{push:(e,t)=>()=>e[r]=a(t),pull:n=>{const s=e.resolver(n.dataset[t]),o=n[r];return o===a(s)?s:o}}}},p=e=>{const t=typeof e;return"object"===t?(e=>{const t=e instanceof HTMLElement&&"element",r=e instanceof Node&&"element",n=e instanceof HTMLElement&&"array";return(null===e?"null":t)||r||n||"object"})(e):t},g=(e={})=>{const t=()=>Object.keys(e.codecs).map(r).join(","),r=t=>`[data-${e.util.asAttr(t)}]`,n=(t,r)=>Object.keys(e.codecs).map((n=>`[data-${e.util.asAttr(n)}${((e,t=!1)=>e?t?`^="${e}"`:`="${e}"`:"")(t,r)}]`)).join(","),a=e=>Object.values(e.dataset).map(n).join(","),s=(e=>(...t)=>e[p(t[0])](...t))({undefined:t,element:a,string:n,object:r}),o={element:a,path:n,codec:r,all:t};return e.util.selectors=Object.assign(s,o),e},b={is:{},config:{root:document}},v=[e=>(e.resolver=(...t)=>{const[r,s]=t;return{0:()=>console.error("resolver has no args."),1:()=>n(e.is,r),2:()=>a(e.is,r,s),3:()=>console.error("resolver has 3 or more args:",t)}[Math.min(t.length,3)]()},e),(r={})=>(r.util=r.util||{},r.util.asAttr=e,r.util.asProp=t,g(r),((e={})=>{const t=e?.config?.root||document,r=e.util.selectors,n={element:(...e)=>[...t.querySelectorAll(r.element(...e))],path:(...e)=>[...t.querySelectorAll(r.path(...e))],codec:(...e)=>[...t.querySelectorAll(r.codec(...e))],all:(...e)=>[...t.querySelectorAll(r.all(...e))]};e.util.elements=Object.assign(((...e)=>[...t.querySelectorAll(r(...e))]),n)})(r),r.util.hide=e=>e.hidden=!0,r.util.show=e=>e.hidden=!1,r),(e={})=>{const t=e.codecs||{},r={text:u("textContent"),html:u("innerHTML"),href:u("href"),src:{push:(e,t)=>()=>{return("string"==typeof(r=t)||r instanceof String)&&t&&(e.src=t);var r},pull:e=>e.src||void 0},...d(e)("show","hidden"),...d(e)("hide","hidden",!1),...d(e)("disable","disabled"),...d(e)("enable","disabled",!1),replace:u("outerHTML"),each:f(e),inject:h(e)};return e.codecs=l(r,t),e}],y=e=>v.reduce(((e,t)=>t(e)),l(b,e)),_=()=>{},m=(e={},t=_,r=!1,o=!1,c=!1)=>{const u=n(e,r)||n(e,c)||{},f=((e={},t=_,r=[])=>i().create(e,t))(u,t);return c&&a(e,c,u),o&&a(e,o,((e,t)=>(...r)=>({0:()=>s(e),1:e=>l(e,t),2:(e,r)=>l(r,n(e,t))}[r.length](...r)))(u,f)),r&&a(e,r,f),f},j=e=>(t="")=>{const r=e.util.elements(t,!0),n=t=>t in e.codecs;r.forEach((t=>Object.keys(t.dataset).filter(n).forEach((t=>r=>{const n=t.dataset[r]&&e.resolver(t.dataset[r]),a=e.codecs[r].push(t,n);requestAnimationFrame(a)})(t))))},O=()=>{},P={subtree:!0,childList:!0,attributes:!0},x=(e=O)=>t=>t.forEach((t=>[t.target,...t.addedNodes].forEach((t=>Promise.resolve().then((()=>{return e((r=t)instanceof Element||r instanceof HTMLDocument?t:t.parentElement);var r})))))),E=(e=document,t=O,r=P)=>((e=O)=>new MutationObserver(x(e)))(t).observe(e,r),k=(e=y)=>(e.puller=(e=>t=>{r(Object.keys(t.dataset),Object.keys(e.codecs)).forEach((r=>{const n=t.dataset[r],a=(0,e.codecs[r].pull)(t);a===e.resolver(n)||e.resolver(n,a)}))})(e),e.pull=()=>e.util.elements().forEach(e.puller),e.domobs=E(document,e.puller,P),e.pull(),e),A=(e=c)=>({oath:function(t){t.catch((e=>this.err=e)).then((t=>t.json().catch((e=>this.err=e)).then((t=>{return r=e(t,this.ok),n=t,void 0===r?n:r;var r,n})).then((e=>this.ok=e))))}}),w=e=>((e=y)=>(e.pushSet=new Set,e.pusher=t=>t.forEach((({currentPath:t})=>j(e)(t))),e.push=j(e),m(e,e.pusher,"is","be","util.raw"),e))(k(y(e)));export{w as Adios,A as Oath};
